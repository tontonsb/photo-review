import{V as f,G as d,f as w,a as E,g as v,P as b,t as x,M as A,T as I,X as L,b as M}from"./XYZ-BFnzgKZ7.js";function _(y,G,P){const c=new f({format:new d,url:G}),u=w([23.54238,56.87841]),S=new E({center:u,zoom:12}),a=v(S.getProjection(),1,u);c.on("featuresloadend",()=>c.forEachFeature(e=>{const r=e.getGeometry();if(r.getType()!=="Point")return;const o=e.get("width_guess_meters"),n=e.get("height_guess_meters"),m=e.get("bearing_degrees");if(!o||!n||!m)return;const s=r.getCoordinates(),g=s[0]-o/2/a,l=s[1]+n/2/a,h=s[0]+o/2/a,p=s[1]-n/2/a,i=new b([[[g,l],[g,p],[h,p],[h,l],[g,l]]]);i.transform("EPSG:3857","EPSG:4326"),i.rotate(-m*Math.PI/180,x(s)),i.transform("EPSG:4326","EPSG:3857"),e.setGeometry(i)}));const t=new A({target:y,layers:[new I({source:new L({attributions:["Powered by Esri","Source: Esri, DigitalGlobe, GeoEye, Earthstar Geographics, CNES/Airbus DS, USDA, USGS, AeroGRID, IGN, and the GIS User Community"],url:"https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}",maxZoom:20})}),new M({source:c})],view:new E({center:w([23.54238,56.87841]),zoom:12})});return t.on("click",function(e){const r=t.getEventPixel(e.originalEvent),o=[];t.forEachFeatureAtPixel(r,n=>{o.push({path:n.get("path"),url:n.get("url")})}),P(o)}),t.on("pointermove",function(e){if(e.dragging)return;t.getTargetElement().style.cursor="";const r=t.getEventPixel(e.originalEvent);t.forEachFeatureAtPixel(r,o=>{if(o.get("path")&&o.get("url"))return t.getTargetElement().style.cursor="pointer",!0})}),t}window.showFeaturesOnMap=_;
