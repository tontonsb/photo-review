import{G as U,u as K,l as H,E as $,h as C,i as W,j as Z,k as z,m as M,n as g,o as B,p as Q,q,r as V,s as b,t as N,v as tt,w as et,x as it,y as T,z as st,A as rt,B as nt,C as ot,D as at,H as lt,J as E,K as ht,c as w,L as dt,N as ut,O as ft,Q as ct,R as gt,U as R,W as yt,Y as mt,Z as pt,_ as Y,$ as Ct,P as S,a0 as _t,a1 as X,a2 as f,a3 as Pt,a4 as Ft,a5 as k,F as I,a6 as d,a7 as Gt,a8 as Mt,a9 as Ot,aa as m}from"./XYZ-DW-6z1kv.js";class P extends U{constructor(t){super(),this.geometries_=t,this.changeEventsKeys_=[],this.listenGeometriesChange_()}unlistenGeometriesChange_(){this.changeEventsKeys_.forEach(K),this.changeEventsKeys_.length=0}listenGeometriesChange_(){const t=this.geometries_;for(let e=0,i=t.length;e<i;++e)this.changeEventsKeys_.push(H(t[e],$.CHANGE,this.changed,this))}clone(){const t=new P(j(this.geometries_));return t.applyProperties(this),t}closestPointXY(t,e,i,s){if(s<C(this.getExtent(),t,e))return s;const r=this.geometries_;for(let o=0,a=r.length;o<a;++o)s=r[o].closestPointXY(t,e,i,s);return s}containsXY(t,e){const i=this.geometries_;for(let s=0,r=i.length;s<r;++s)if(i[s].containsXY(t,e))return!0;return!1}computeExtent(t){W(t);const e=this.geometries_;for(let i=0,s=e.length;i<s;++i)Z(t,e[i].getExtent());return t}getGeometries(){return j(this.geometries_)}getGeometriesArray(){return this.geometries_}getGeometriesArrayRecursive(){let t=[];const e=this.geometries_;for(let i=0,s=e.length;i<s;++i)e[i].getType()===this.getType()?t=t.concat(e[i].getGeometriesArrayRecursive()):t.push(e[i]);return t}getSimplifiedGeometry(t){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),t<0||this.simplifiedGeometryMaxMinSquaredTolerance!==0&&t<this.simplifiedGeometryMaxMinSquaredTolerance)return this;const e=[],i=this.geometries_;let s=!1;for(let r=0,o=i.length;r<o;++r){const a=i[r],l=a.getSimplifiedGeometry(t);e.push(l),l!==a&&(s=!0)}return s?new P(e):(this.simplifiedGeometryMaxMinSquaredTolerance=t,this)}getType(){return"GeometryCollection"}intersectsExtent(t){const e=this.geometries_;for(let i=0,s=e.length;i<s;++i)if(e[i].intersectsExtent(t))return!0;return!1}isEmpty(){return this.geometries_.length===0}rotate(t,e){const i=this.geometries_;for(let s=0,r=i.length;s<r;++s)i[s].rotate(t,e);this.changed()}scale(t,e,i){i||(i=z(this.getExtent()));const s=this.geometries_;for(let r=0,o=s.length;r<o;++r)s[r].scale(t,e,i);this.changed()}setGeometries(t){this.setGeometriesArray(j(t))}setGeometriesArray(t){this.unlistenGeometriesChange_(),this.geometries_=t,this.listenGeometriesChange_(),this.changed()}applyTransform(t){const e=this.geometries_;for(let i=0,s=e.length;i<s;++i)e[i].applyTransform(t);this.changed()}translate(t,e){const i=this.geometries_;for(let s=0,r=i.length;s<r;++s)i[s].translate(t,e);this.changed()}disposeInternal(){this.unlistenGeometriesChange_(),super.disposeInternal()}}function j(n){return n.map(t=>t.clone())}class y extends M{constructor(t,e){super(),this.flatMidpoint_=null,this.flatMidpointRevision_=-1,this.maxDelta_=-1,this.maxDeltaRevision_=-1,e!==void 0&&!Array.isArray(t[0])?this.setFlatCoordinates(e,t):this.setCoordinates(t,e)}appendCoordinate(t){g(this.flatCoordinates,t),this.changed()}clone(){const t=new y(this.flatCoordinates.slice(),this.layout);return t.applyProperties(this),t}closestPointXY(t,e,i,s){return s<C(this.getExtent(),t,e)?s:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(B(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),Q(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!1,t,e,i,s))}forEachSegment(t){return q(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)}getCoordinateAtM(t,e){return this.layout!="XYM"&&this.layout!="XYZM"?null:(e=e!==void 0?e:!1,V(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,e))}getCoordinates(){return b(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getCoordinateAt(t,e){return N(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,e,this.stride)}getLength(){return tt(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getFlatMidpoint(){return this.flatMidpointRevision_!=this.getRevision()&&(this.flatMidpoint_=this.getCoordinateAt(.5,this.flatMidpoint_??void 0),this.flatMidpointRevision_=this.getRevision()),this.flatMidpoint_}getSimplifiedGeometryInternal(t){const e=[];return e.length=et(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,e,0),new y(e,"XY")}getType(){return"LineString"}intersectsExtent(t){return it(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)}setCoordinates(t,e){this.setLayout(e,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=T(this.flatCoordinates,0,t,this.stride),this.changed()}}class F extends M{constructor(t,e,i){if(super(),this.ends_=[],this.maxDelta_=-1,this.maxDeltaRevision_=-1,Array.isArray(t[0]))this.setCoordinates(t,e);else if(e!==void 0&&i)this.setFlatCoordinates(e,t),this.ends_=i;else{const s=t,r=[],o=[];for(let l=0,h=s.length;l<h;++l){const u=s[l];g(r,u.getFlatCoordinates()),o.push(r.length)}const a=s.length===0?this.getLayout():s[0].getLayout();this.setFlatCoordinates(a,r),this.ends_=o}}appendLineString(t){g(this.flatCoordinates,t.getFlatCoordinates().slice()),this.ends_.push(this.flatCoordinates.length),this.changed()}clone(){const t=new F(this.flatCoordinates.slice(),this.layout,this.ends_.slice());return t.applyProperties(this),t}closestPointXY(t,e,i,s){return s<C(this.getExtent(),t,e)?s:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(st(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),rt(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!1,t,e,i,s))}getCoordinateAtM(t,e,i){return this.layout!="XYM"&&this.layout!="XYZM"||this.flatCoordinates.length===0?null:(e=e!==void 0?e:!1,i=i!==void 0?i:!1,nt(this.flatCoordinates,0,this.ends_,this.stride,t,e,i))}getCoordinates(){return ot(this.flatCoordinates,0,this.ends_,this.stride)}getEnds(){return this.ends_}getLineString(t){return t<0||this.ends_.length<=t?null:new y(this.flatCoordinates.slice(t===0?0:this.ends_[t-1],this.ends_[t]),this.layout)}getLineStrings(){const t=this.flatCoordinates,e=this.ends_,i=this.layout,s=[];let r=0;for(let o=0,a=e.length;o<a;++o){const l=e[o],h=new y(t.slice(r,l),i);s.push(h),r=l}return s}getFlatMidpoints(){const t=[],e=this.flatCoordinates;let i=0;const s=this.ends_,r=this.stride;for(let o=0,a=s.length;o<a;++o){const l=s[o],h=N(e,i,l,r,.5);g(t,h),i=l}return t}getSimplifiedGeometryInternal(t){const e=[],i=[];return e.length=at(this.flatCoordinates,0,this.ends_,this.stride,t,e,0,i),new F(e,"XY",i)}getType(){return"MultiLineString"}intersectsExtent(t){return lt(this.flatCoordinates,0,this.ends_,this.stride,t)}setCoordinates(t,e){this.setLayout(e,t,2),this.flatCoordinates||(this.flatCoordinates=[]);const i=E(this.flatCoordinates,0,t,this.stride,this.ends_);this.flatCoordinates.length=i.length===0?0:i[i.length-1],this.changed()}}class O extends M{constructor(t,e){super(),e&&!Array.isArray(t[0])?this.setFlatCoordinates(e,t):this.setCoordinates(t,e)}appendPoint(t){g(this.flatCoordinates,t.getFlatCoordinates()),this.changed()}clone(){const t=new O(this.flatCoordinates.slice(),this.layout);return t.applyProperties(this),t}closestPointXY(t,e,i,s){if(s<C(this.getExtent(),t,e))return s;const r=this.flatCoordinates,o=this.stride;for(let a=0,l=r.length;a<l;a+=o){const h=ht(t,e,r[a],r[a+1]);if(h<s){s=h;for(let u=0;u<o;++u)i[u]=r[a+u];i.length=o}}return s}getCoordinates(){return b(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getPoint(t){const e=this.flatCoordinates.length/this.stride;return t<0||e<=t?null:new w(this.flatCoordinates.slice(t*this.stride,(t+1)*this.stride),this.layout)}getPoints(){const t=this.flatCoordinates,e=this.layout,i=this.stride,s=[];for(let r=0,o=t.length;r<o;r+=i){const a=new w(t.slice(r,r+i),e);s.push(a)}return s}getType(){return"MultiPoint"}intersectsExtent(t){const e=this.flatCoordinates,i=this.stride;for(let s=0,r=e.length;s<r;s+=i){const o=e[s],a=e[s+1];if(dt(t,o,a))return!0}return!1}setCoordinates(t,e){this.setLayout(e,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=T(this.flatCoordinates,0,t,this.stride),this.changed()}}class G extends M{constructor(t,e,i){if(super(),this.endss_=[],this.flatInteriorPointsRevision_=-1,this.flatInteriorPoints_=null,this.maxDelta_=-1,this.maxDeltaRevision_=-1,this.orientedRevision_=-1,this.orientedFlatCoordinates_=null,!i&&!Array.isArray(t[0])){const s=t,r=[],o=[];for(let a=0,l=s.length;a<l;++a){const h=s[a],u=r.length,c=h.getEnds();for(let p=0,D=c.length;p<D;++p)c[p]+=u;g(r,h.getFlatCoordinates()),o.push(c)}e=s.length===0?this.getLayout():s[0].getLayout(),t=r,i=o}e!==void 0&&i?(this.setFlatCoordinates(e,t),this.endss_=i):this.setCoordinates(t,e)}appendPolygon(t){let e;if(!this.flatCoordinates)this.flatCoordinates=t.getFlatCoordinates().slice(),e=t.getEnds().slice(),this.endss_.push();else{const i=this.flatCoordinates.length;g(this.flatCoordinates,t.getFlatCoordinates()),e=t.getEnds().slice();for(let s=0,r=e.length;s<r;++s)e[s]+=i}this.endss_.push(e),this.changed()}clone(){const t=this.endss_.length,e=new Array(t);for(let s=0;s<t;++s)e[s]=this.endss_[s].slice();const i=new G(this.flatCoordinates.slice(),this.layout,e);return i.applyProperties(this),i}closestPointXY(t,e,i,s){return s<C(this.getExtent(),t,e)?s:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(ut(this.flatCoordinates,0,this.endss_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),ft(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,this.maxDelta_,!0,t,e,i,s))}containsXY(t,e){return ct(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,t,e)}getArea(){return gt(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride)}getCoordinates(t){let e;return t!==void 0?(e=this.getOrientedFlatCoordinates().slice(),R(e,0,this.endss_,this.stride,t)):e=this.flatCoordinates,yt(e,0,this.endss_,this.stride)}getEndss(){return this.endss_}getFlatInteriorPoints(){if(this.flatInteriorPointsRevision_!=this.getRevision()){const t=mt(this.flatCoordinates,0,this.endss_,this.stride);this.flatInteriorPoints_=pt(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,t),this.flatInteriorPointsRevision_=this.getRevision()}return this.flatInteriorPoints_}getInteriorPoints(){return new O(this.getFlatInteriorPoints().slice(),"XYM")}getOrientedFlatCoordinates(){if(this.orientedRevision_!=this.getRevision()){const t=this.flatCoordinates;Y(t,0,this.endss_,this.stride)?this.orientedFlatCoordinates_=t:(this.orientedFlatCoordinates_=t.slice(),this.orientedFlatCoordinates_.length=R(this.orientedFlatCoordinates_,0,this.endss_,this.stride)),this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_}getSimplifiedGeometryInternal(t){const e=[],i=[];return e.length=Ct(this.flatCoordinates,0,this.endss_,this.stride,Math.sqrt(t),e,0,i),new G(e,"XY",i)}getPolygon(t){if(t<0||this.endss_.length<=t)return null;let e;if(t===0)e=0;else{const r=this.endss_[t-1];e=r[r.length-1]}const i=this.endss_[t].slice(),s=i[i.length-1];if(e!==0)for(let r=0,o=i.length;r<o;++r)i[r]-=e;return new S(this.flatCoordinates.slice(e,s),this.layout,i)}getPolygons(){const t=this.layout,e=this.flatCoordinates,i=this.endss_,s=[];let r=0;for(let o=0,a=i.length;o<a;++o){const l=i[o].slice(),h=l[l.length-1];if(r!==0)for(let c=0,p=l.length;c<p;++c)l[c]-=r;const u=new S(e.slice(r,h),t,l);s.push(u),r=h}return s}getType(){return"MultiPolygon"}intersectsExtent(t){return _t(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,t)}setCoordinates(t,e){this.setLayout(e,t,3),this.flatCoordinates||(this.flatCoordinates=[]);const i=X(this.flatCoordinates,0,t,this.stride,this.endss_);if(i.length===0)this.flatCoordinates.length=0;else{const s=i[i.length-1];this.flatCoordinates.length=s.length===0?0:s[s.length-1]}this.changed()}}class jt{constructor(){this.dataProjection=void 0,this.defaultFeatureProjection=void 0,this.featureClass=I,this.supportedMediaTypes=null}getReadOptions(t,e){if(e){let i=e.dataProjection?f(e.dataProjection):this.readProjection(t);e.extent&&i&&i.getUnits()==="tile-pixels"&&(i=f(i),i.setWorldExtent(e.extent)),e={dataProjection:i,featureProjection:e.featureProjection}}return this.adaptOptions(e)}adaptOptions(t){return Object.assign({dataProjection:this.dataProjection,featureProjection:this.defaultFeatureProjection,featureClass:this.featureClass},t)}getType(){return d()}readFeature(t,e){return d()}readFeatures(t,e){return d()}readGeometry(t,e){return d()}readProjection(t){return d()}writeFeature(t,e){return d()}writeFeatures(t,e){return d()}writeGeometry(t,e){return d()}}function v(n,t,e){const i=e?f(e.featureProjection):null,s=e?f(e.dataProjection):null;let r=n;if(i&&s&&!Pt(i,s)){t&&(r=n.clone());const o=t?i:s,a=t?s:i;o.getUnits()==="tile-pixels"?r.transform(o,a):r.applyTransform(Ft(o,a))}if(t&&e&&e.decimals!==void 0){const o=Math.pow(10,e.decimals),a=function(l){for(let h=0,u=l.length;h<u;++h)l[h]=Math.round(l[h]*o)/o;return l};r===n&&(r=n.clone()),r.applyTransform(a)}return r}const wt={Point:w,LineString:y,Polygon:S,MultiPoint:O,MultiLineString:F,MultiPolygon:G};function Rt(n,t,e){return Array.isArray(t[0])?(Y(n,0,t,e)||(n=n.slice(),R(n,0,t,e)),n):(Gt(n,0,t,e)||(n=n.slice(),Mt(n,0,t,e)),n)}function J(n,t){var r;const e=n.geometry;if(!e)return[];if(Array.isArray(e))return e.map(o=>J({...n,geometry:o})).flat();const i=e.type==="MultiPolygon"?"Polygon":e.type;if(i==="GeometryCollection"||i==="Circle")throw new Error("Unsupported geometry type: "+i);const s=e.layout.length;return v(new k(i,i==="Polygon"?Rt(e.flatCoordinates,e.ends,s):e.flatCoordinates,(r=e.ends)==null?void 0:r.flat(),s,n.properties||{},n.id).enableSimplifyTransformed(),!1,t)}function x(n,t){if(!n)return null;if(Array.isArray(n)){const i=n.map(s=>x(s,t));return new P(i)}const e=wt[n.type];return v(new e(n.flatCoordinates,n.layout,n.ends),!1,t)}class St extends jt{constructor(){super()}getType(){return"json"}readFeature(t,e){return this.readFeatureFromObject(_(t),this.getReadOptions(t,e))}readFeatures(t,e){return this.readFeaturesFromObject(_(t),this.getReadOptions(t,e))}readFeatureFromObject(t,e){return d()}readFeaturesFromObject(t,e){return d()}readGeometry(t,e){return this.readGeometryFromObject(_(t),this.getReadOptions(t,e))}readGeometryFromObject(t,e){return d()}readProjection(t){return this.readProjectionFromObject(_(t))}readProjectionFromObject(t){return d()}writeFeature(t,e){return JSON.stringify(this.writeFeatureObject(t,e))}writeFeatureObject(t,e){return d()}writeFeatures(t,e){return JSON.stringify(this.writeFeaturesObject(t,e))}writeFeaturesObject(t,e){return d()}writeGeometry(t,e){return JSON.stringify(this.writeGeometryObject(t,e))}writeGeometryObject(t,e){return d()}}function _(n){if(typeof n=="string"){const t=JSON.parse(n);return t||null}return n!==null?n:null}class Ht extends St{constructor(t){t=t||{},super(),this.dataProjection=f(t.dataProjection?t.dataProjection:"EPSG:4326"),t.featureProjection&&(this.defaultFeatureProjection=f(t.featureProjection)),t.featureClass&&(this.featureClass=t.featureClass),this.geometryName_=t.geometryName,this.extractGeometryName_=t.extractGeometryName,this.supportedMediaTypes=["application/geo+json","application/vnd.geo+json"]}readFeatureFromObject(t,e){let i=null;t.type==="Feature"?i=t:i={type:"Feature",geometry:t,properties:null};const s=L(i.geometry);if(this.featureClass===k)return J({geometry:s,id:i.id,properties:i.properties},e);const r=new I;return this.geometryName_?r.setGeometryName(this.geometryName_):this.extractGeometryName_&&i.geometry_name&&r.setGeometryName(i.geometry_name),r.setGeometry(x(s,e)),"id"in i&&r.setId(i.id),i.properties&&r.setProperties(i.properties,!0),r}readFeaturesFromObject(t,e){const i=t;let s=null;if(i.type==="FeatureCollection"){const r=t;s=[];const o=r.features;for(let a=0,l=o.length;a<l;++a){const h=this.readFeatureFromObject(o[a],e);h&&s.push(h)}}else s=[this.readFeatureFromObject(t,e)];return s.flat()}readGeometryFromObject(t,e){return At(t,e)}readProjectionFromObject(t){const e=t.crs;let i;if(e)if(e.type=="name")i=f(e.properties.name);else if(e.type==="EPSG")i=f("EPSG:"+e.properties.code);else throw new Error("Unknown SRS type");else i=this.dataProjection;return i}writeFeatureObject(t,e){e=this.adaptOptions(e);const i={type:"Feature",geometry:null,properties:null},s=t.getId();if(s!==void 0&&(i.id=s),!t.hasProperties())return i;const r=t.getProperties(),o=t.getGeometry();return o&&(i.geometry=A(o,e),delete r[t.getGeometryName()]),Ot(r)||(i.properties=r),i}writeFeaturesObject(t,e){e=this.adaptOptions(e);const i=[];for(let s=0,r=t.length;s<r;++s)i.push(this.writeFeatureObject(t[s],e));return{type:"FeatureCollection",features:i}}writeGeometryObject(t,e){return A(t,this.adaptOptions(e))}}function L(n,t){if(!n)return null;let e;switch(n.type){case"Point":{e=vt(n);break}case"LineString":{e=xt(n);break}case"Polygon":{e=Tt(n);break}case"MultiPoint":{e=bt(n);break}case"MultiLineString":{e=Lt(n);break}case"MultiPolygon":{e=Nt(n);break}case"GeometryCollection":{e=Et(n);break}default:throw new Error("Unsupported GeoJSON type: "+n.type)}return e}function At(n,t){const e=L(n);return x(e,t)}function Et(n,t){return n.geometries.map(function(i){return L(i)})}function vt(n){const t=n.coordinates;return{type:"Point",flatCoordinates:t,layout:m(t.length)}}function xt(n){var i;const t=n.coordinates,e=t.flat();return{type:"LineString",flatCoordinates:e,ends:[e.length],layout:m(((i=t[0])==null?void 0:i.length)||2)}}function Lt(n){var r,o;const t=n.coordinates,e=((o=(r=t[0])==null?void 0:r[0])==null?void 0:o.length)||2,i=[],s=E(i,0,t,e);return{type:"MultiLineString",flatCoordinates:i,ends:s,layout:m(e)}}function bt(n){var e;const t=n.coordinates;return{type:"MultiPoint",flatCoordinates:t.flat(),layout:m(((e=t[0])==null?void 0:e.length)||2)}}function Nt(n){var r,o;const t=n.coordinates,e=[],i=((o=(r=t[0])==null?void 0:r[0])==null?void 0:o[0].length)||2,s=X(e,0,t,i);return{type:"MultiPolygon",flatCoordinates:e,ends:s,layout:m(i)}}function Tt(n){var r,o;const t=n.coordinates,e=[],i=(o=(r=t[0])==null?void 0:r[0])==null?void 0:o.length,s=E(e,0,t,i);return{type:"Polygon",flatCoordinates:e,ends:s,layout:m(i)}}function A(n,t){n=v(n,!0,t);const e=n.getType();let i;switch(e){case"Point":{i=Dt(n);break}case"LineString":{i=Xt(n);break}case"Polygon":{i=Ut(n,t);break}case"MultiPoint":{i=It(n);break}case"MultiLineString":{i=kt(n);break}case"MultiPolygon":{i=Jt(n,t);break}case"GeometryCollection":{i=Yt(n,t);break}case"Circle":{i={type:"GeometryCollection",geometries:[]};break}default:throw new Error("Unsupported geometry type: "+e)}return i}function Yt(n,t){return t=Object.assign({},t),delete t.featureProjection,{type:"GeometryCollection",geometries:n.getGeometriesArray().map(function(i){return A(i,t)})}}function Xt(n,t){return{type:"LineString",coordinates:n.getCoordinates()}}function kt(n,t){return{type:"MultiLineString",coordinates:n.getCoordinates()}}function It(n,t){return{type:"MultiPoint",coordinates:n.getCoordinates()}}function Jt(n,t){let e;return t&&(e=t.rightHanded),{type:"MultiPolygon",coordinates:n.getCoordinates(e)}}function Dt(n,t){return{type:"Point",coordinates:n.getCoordinates()}}function Ut(n,t){let e;return t&&(e=t.rightHanded),{type:"Polygon",coordinates:n.getCoordinates(e)}}export{Ht as G};
